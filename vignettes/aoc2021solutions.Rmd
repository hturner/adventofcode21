---
title: "Advent of Code 2021 Solutions"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Advent of Code 2021 Solutions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup , include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = ""
)
```

```{r}
library(adventofcode21)
```


## Day 1

Compute sum of positive differences between values:

```{r f01a}
x <- read.table(system.file("input01.txt", package = "adventofcode21"))[[1]]
f01a(x)
```

Compute sum of positive differences between sums of three consecutive values:

```{r f01b}
f01b(x)
```

## Day 2

```{r input-data}
x <- read.table(system.file("input02.txt", package = "adventofcode21"),
                col.names = c("direction", "amount"))
head(x)
```

Compute horizontal location and depth

```{r}
position <- f02a(x$direction, x$amount)
position
```
Compute product
```{r}
prod(position)
```
Compute horizontal location and depth based on aim

```{r}
position <- f02b(x$direction, x$amount)
position
```
Compute product
```{r}
prod(position)
```
# Day 3

Gamma and epsilon rate:

```{r f03a}
x <- read.fwf(system.file("input03.txt", package = "adventofcode21"), 
              widths = rep(1, 12))
x <- as.matrix(x)
rates <- f03a(x)
rates
```

Power consumption

```{r}
prod(rates)
```
Oxygen generator rating and CO2 scrubber rating

```{r}
rating <- f03b(x)
rating
```
```{r}
prod(rating)
```
# Day 4

```{r}
x <- list()
x[[1]] <- scan(system.file("input04.txt", package = "adventofcode21"), 
               sep = ",", nlines = 1)
x[[2]] <- list()
for (i in 1:1000){
   res <- 
    try(as.matrix(read.fwf(system.file("input04.txt", 
                                       package = "adventofcode21"), 
                           widths = rep(3, 5), skip = 2 + (i - 1)*6, n = 5)),
        silent = TRUE)
   if (!inherits(res, "try-error")) {
     x[[2]][[i]] <- res
   } else break
}
prod(f04a(x[[1]], x[[2]]))
```
```{r}
prod(f04b(x[[1]], x[[2]]))
```

