---
title: "Advent of Code 2021 Solutions"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Advent of Code 2021 Solutions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup , include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = ""
)
```

```{r}
library(adventofcode21)
```


## Day 1

Compute sum of positive differences between values:

```{r f01a}
x <- read.table(system.file("input01.txt", package = "adventofcode21"))[[1]]
f01a(x)
```

Compute sum of positive differences between sums of three consecutive values:

```{r f01b}
f01b(x)
```

## Day 2

```{r input-data}
x <- read.table(system.file("input02.txt", package = "adventofcode21"),
                col.names = c("direction", "amount"))
head(x)
```

Compute horizontal location and depth

```{r}
position <- f02a(x$direction, x$amount)
position
```
Compute product
```{r}
prod(position)
```
Compute horizontal location and depth based on aim

```{r}
position <- f02b(x$direction, x$amount)
position
```
Compute product
```{r}
prod(position)
```
# Day 3

Gamma and epsilon rate:

```{r f03a}
x <- read.fwf(system.file("input03.txt", package = "adventofcode21"), 
              widths = rep(1, 12))
x <- as.matrix(x)
rates <- f03a(x)
rates
```

Power consumption

```{r}
prod(rates)
```
Oxygen generator rating and CO2 scrubber rating

```{r}
rating <- f03b(x)
rating
```
```{r}
prod(rating)
```
# Day 4

```{r}
x <- list()
x[[1]] <- scan(system.file("input04.txt", package = "adventofcode21"), 
               sep = ",", nlines = 1)
x[[2]] <- list()
for (i in 1:1000){
   res <- 
    try(as.matrix(read.fwf(system.file("input04.txt", 
                                       package = "adventofcode21"), 
                           widths = rep(3, 5), skip = 2 + (i - 1)*6, n = 5)),
        silent = TRUE)
   if (!inherits(res, "try-error")) {
     x[[2]][[i]] <- res
   } else break
}
prod(f04a(x[[1]], x[[2]]))
```
```{r}
prod(f04b(x[[1]], x[[2]]))
```
## Day 5

```{r}
x <- read.table(system.file("input05.txt", 
                            package = "adventofcode21"),
                sep = ",", col.names = c("x1", "y1x2", "y2"))
x$y1 <- as.numeric(gsub("([0-9]*)[ ].*", "\\1", x$y1x2))
x$x2 <- as.numeric(gsub("[0-9]*[ ]->[ ]([0-9]*)", "\\1", x$y1x2))
f05a(x$x1, x$y1, x$x2, x$y2)
```

# Day 6

```{r}
x <- scan(system.file("input06.txt", package = "adventofcode21"),sep = ',')
```

```{r}
f06a(x,80)
```

```{r}
res <- f06a(x,256)
format(res, digits = 15)
```

# Day 7

```{r}
x <- scan(system.file("input07.txt", package = "adventofcode21"),sep = ',')
```

```{r}
f07a(x)
```
```{r}
f07b(x)
```

## Day 8

```{r}
x <- as.matrix(read.table(system.file("input08.txt", package = "adventofcode21"),sep = ' '))[,-11]
```

```{r}
f08a(x)
```

```{r}
f08b(x)
```
# Day 9

```{r}
x <- as.matrix(read.fwf(system.file("input09.txt", package = "adventofcode21"), widths = rep(1, 100)))
```

```{r}
f09a(x)
```
works on example data, but not correct solution...

```{r}
f09b(x)
```
# Day 10

```{r}
x <- scan(system.file("input10.txt", package = "adventofcode21"),
          "character")
```
```{r}
sum(f10a(x))
```
```{r}
f10b(x)
```
## Day 11

```{r}
x <- as.matrix(read.fwf(system.file("input11.txt", package = "adventofcode21"),
                        widths = rep(1, 10)))
```

```{r}
f11a(x, 100)
```
```{r}
f11b(x)
```
